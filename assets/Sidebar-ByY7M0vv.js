class b{constructor(e={}){this.scriptUrl=e.scriptUrl,this.initialized=!1}async initialize(){if(!this.scriptUrl)throw new Error("scriptUrl √© obrigat√≥rio");return this.initialized=!0,!0}eventToObject(e){return{id:e.id,title:e.title||"",description:e.description||"",date:e.date,startTime:e.startTime||"",endTime:e.endTime||"",color:e.color||"#3b82f6",createdAt:e.createdAt,updatedAt:e.updatedAt}}async saveEvent(e){this.initialized||await this.initialize();try{console.log("üíæ GoogleAppsScriptService.saveEvent - Evento recebido:",{id:e.id,title:e.title,date:e.date,startTime:e.startTime,endTime:e.endTime});const t=this.eventToObject(e);return console.log("üì§ Enviando para Google Apps Script (CREATE):",t),await fetch(this.scriptUrl,{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"create",data:t})}),console.log("‚úÖ Evento enviado para Google Apps Script (action: create)"),e}catch(t){const s=t.message||String(t);if(s.includes("Failed to fetch")||s.includes("NetworkError")||s.includes("CORS"))return console.log("‚ö†Ô∏è N√£o foi poss√≠vel verificar resposta (no-cors), mas a requisi√ß√£o foi enviada"),console.log("‚úÖ Assumindo que o evento foi salvo com sucesso"),e;throw console.error("Erro ao salvar evento via Apps Script:",t),t}}async updateEvent(e){this.initialized||await this.initialize();try{console.log("üîÑ GoogleAppsScriptService.updateEvent - Evento recebido:",{id:e.id,title:e.title,date:e.date,startTime:e.startTime,endTime:e.endTime});const t=this.eventToObject(e);return console.log("üì§ Enviando para Google Apps Script:",{action:"update",data:t}),await fetch(this.scriptUrl,{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"update",data:t})}),console.log("‚úÖ Evento atualizado via Google Apps Script (action: update)"),e}catch(t){const s=t.message||String(t);if(s.includes("Failed to fetch")||s.includes("NetworkError")||s.includes("CORS"))return console.log("‚ö†Ô∏è N√£o foi poss√≠vel verificar resposta (no-cors), mas a requisi√ß√£o foi enviada"),console.log("‚úÖ Assumindo que o evento foi atualizado com sucesso"),e;throw console.error("Erro ao atualizar evento via Apps Script:",t),t}}async deleteEvent(e){this.initialized||await this.initialize();try{const t=await fetch(this.scriptUrl,{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"delete",id:e})});return console.log("‚úÖ Evento exclu√≠do via Google Apps Script"),{id:e}}catch(t){const s=t.message||String(t);if(s.includes("Failed to fetch")||s.includes("NetworkError")||s.includes("CORS"))return console.log("‚ö†Ô∏è N√£o foi poss√≠vel verificar resposta (no-cors), mas a requisi√ß√£o foi enviada"),console.log("‚úÖ Assumindo que o evento foi exclu√≠do com sucesso"),{id:e};throw console.error("Erro ao excluir evento via Apps Script:",t),t}}async loadEvents(){this.initialized||await this.initialize();try{const e=new URL(this.scriptUrl);e.searchParams.append("action","read");const t=await fetch(e.toString(),{method:"GET",mode:"cors"});if(t.ok){const s=await t.json();if(s.success&&s.events){const a=s.events.map(i=>{if(i.date)if(i.date.includes("T")||i.date.includes("Z")){const r=new Date(i.date),n=r.getFullYear(),c=String(r.getMonth()+1).padStart(2,"0"),l=String(r.getDate()).padStart(2,"0");i.date=`${n}-${c}-${l}`}else if(i.date.match(/^\d{4}-\d{2}-\d{2}$/))i.date=i.date;else{const r=new Date(i.date);if(!isNaN(r.getTime())){const n=r.getFullYear(),c=String(r.getMonth()+1).padStart(2,"0"),l=String(r.getDate()).padStart(2,"0");i.date=`${n}-${c}-${l}`}}if(i.startTime){const r=String(i.startTime).trim(),n=r.match(/(\d{1,2}):(\d{2})(?::\d{2})?/);if(n){const c=n[1].padStart(2,"0"),l=n[2];i.startTime=`${c}:${l}`}else i.startTime=r}if(i.endTime){const r=String(i.endTime).trim(),n=r.match(/(\d{1,2}):(\d{2})(?::\d{2})?/);if(n){const c=n[1].padStart(2,"0"),l=n[2];i.endTime=`${c}:${l}`}else i.endTime=r}return i});return console.log(`‚úÖ ${a.length} evento(s) carregado(s) do Google Sheets`),a}else return console.warn("Resposta do Apps Script:",s),[]}else return console.warn("Erro ao carregar eventos:",t.status,t.statusText),[]}catch(e){return console.error("Erro ao carregar eventos via Apps Script:",e),[]}}async saveAction(e){this.initialized||await this.initialize();try{console.log("üíæ GoogleAppsScriptService.saveAction - A√ß√£o recebida:",e);const t={id:e.id||"",title:e.title||"",description:e.description||"",createdAt:e.createdAt||new Date().toISOString(),createdDate:e.createdDate||new Date().toISOString().split("T")[0],createdTime:e.createdTime||"",finishedDate:e.finishedDate||"",finishedTime:e.finishedTime||""};return console.log("üì§ Enviando para Google Apps Script (action: saveAction):",t),await fetch(this.scriptUrl,{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"saveAction",data:t})}),console.log("‚úÖ A√ß√£o enviada para Google Apps Script (action: saveAction)"),t}catch(t){const s=t.message||String(t);if(s.includes("Failed to fetch")||s.includes("NetworkError")||s.includes("CORS"))return console.log("‚ö†Ô∏è N√£o foi poss√≠vel verificar resposta (no-cors), mas a requisi√ß√£o foi enviada"),console.log("‚úÖ Assumindo que a a√ß√£o foi salva com sucesso"),e;throw console.error("Erro ao salvar a√ß√£o via Apps Script:",t),t}}async updateAction(e){this.initialized||await this.initialize();try{return console.log("üîÑ GoogleAppsScriptService.updateAction - A√ß√£o recebida:",e),await fetch(this.scriptUrl,{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"updateAction",data:e})}),console.log("‚úÖ A√ß√£o atualizada no Google Apps Script (action: updateAction)"),e}catch(t){const s=t.message||String(t);if(s.includes("Failed to fetch")||s.includes("NetworkError")||s.includes("CORS"))return console.log("‚ö†Ô∏è N√£o foi poss√≠vel verificar resposta (no-cors), mas a requisi√ß√£o foi enviada"),console.log("‚úÖ Assumindo que a a√ß√£o foi atualizada com sucesso"),e;throw console.error("Erro ao atualizar a√ß√£o via Apps Script:",t),t}}async getActionByEventId(e){this.initialized||await this.initialize();try{const t=new URL(this.scriptUrl);t.searchParams.append("action","getAction"),t.searchParams.append("eventId",e);const s=await fetch(t.toString(),{method:"GET",mode:"cors"});if(s.ok){const a=await s.json();if(a.success&&a.action)return a.action}return null}catch(t){return console.error("Erro ao buscar a√ß√£o:",t),null}}async getActions(e={}){this.initialized||await this.initialize();try{const t=new URL(this.scriptUrl);t.searchParams.append("action","getActions"),e.startDate&&t.searchParams.append("startDate",e.startDate),e.endDate&&t.searchParams.append("endDate",e.endDate);const s=await fetch(t.toString(),{method:"GET",mode:"cors"});if(s.ok){const a=await s.json();return a.success&&Array.isArray(a.actions)?(console.log(`‚úÖ ${a.actions.length} a√ß√µes encontradas`),a.actions):(console.log("‚ÑπÔ∏è Nenhuma a√ß√£o encontrada"),[])}else return console.warn("Erro ao buscar a√ß√µes:",s.status,s.statusText),[]}catch(t){return console.error("Erro ao buscar a√ß√µes via Apps Script:",t),[]}}}class S{constructor(e={}){this.storageKey=e.storageKey||"calendar-events"}async initialize(){return!0}async saveEvent(e){try{const t=this.loadEventsFromStorage();return t.push(e),this.saveEventsToStorage(t),console.log("‚úÖ Evento salvo no armazenamento local"),e}catch(t){throw console.error("Erro ao salvar evento:",t),t}}async updateEvent(e){try{const t=this.loadEventsFromStorage(),s=t.findIndex(a=>a.id===e.id);if(s===-1)throw new Error("Evento n√£o encontrado");return t[s]=e,this.saveEventsToStorage(t),console.log("‚úÖ Evento atualizado no armazenamento local"),e}catch(t){throw console.error("Erro ao atualizar evento:",t),t}}async deleteEvent(e){try{const s=this.loadEventsFromStorage().filter(a=>a.id!==e);return this.saveEventsToStorage(s),console.log("‚úÖ Evento exclu√≠do do armazenamento local"),{id:e}}catch(t){throw console.error("Erro ao excluir evento:",t),t}}async loadEvents(){try{return this.loadEventsFromStorage()}catch(e){return console.error("Erro ao carregar eventos:",e),[]}}loadEventsFromStorage(){try{const e=localStorage.getItem(this.storageKey);return e?JSON.parse(e):[]}catch(e){return console.error("Erro ao ler do localStorage:",e),[]}}saveEventsToStorage(e){try{localStorage.setItem(this.storageKey,JSON.stringify(e))}catch(t){throw console.error("Erro ao salvar no localStorage:",t),t}}clear(){localStorage.removeItem(this.storageKey)}}class E{constructor(e="Usu√°rio",t="home"){this.username=e,this.currentPage=t}render(){return`
      <!-- Overlay para mobile -->
      <div id="sidebar-overlay" class="sidebar-overlay hidden"></div>

      <!-- Sidebar Menu -->
      <aside id="sidebar" class="sidebar">
        <div class="sidebar-header">
          <div class="flex items-center justify-between mb-6">
            <div class="sidebar-header-content">
              <h2 class="text-xl font-bold text-white">Ambiente Dev</h2>
              <p class="text-sm text-gray-400 sidebar-username">${this.username}</p>
            </div>
            <div class="flex items-center gap-2">
              <button id="sidebar-toggle-desktop" class="sidebar-close-btn hidden lg:flex" title="Fechar menu">
                <i class="fas fa-chevron-left"></i>
              </button>
              <button id="sidebar-close" class="sidebar-close-btn lg:hidden">
                <i class="fas fa-times"></i>
              </button>
            </div>
          </div>
        </div>
        
        <nav class="sidebar-nav">
          <a href="/home.html" class="sidebar-item ${this.currentPage==="home"?"active":""}" data-page="home">
            <i class="fas fa-home"></i>
            <span class="sidebar-item-text">Home</span>
          </a>
          <a href="/agenda.html" class="sidebar-item ${this.currentPage==="agenda"?"active":""}" data-page="agenda">
            <i class="fas fa-calendar"></i>
            <span class="sidebar-item-text">Agenda</span>
          </a>
          <a href="/dashboard.html" class="sidebar-item ${this.currentPage==="dashboard"?"active":""}" data-page="dashboard">
            <i class="fas fa-chart-bar"></i>
            <span class="sidebar-item-text">Dashboard</span>
          </a>
        </nav>

        <div class="sidebar-footer">
          <button id="logout-btn" class="sidebar-item sidebar-item-logout">
            <i class="fas fa-sign-out-alt"></i>
            <span class="sidebar-item-text">Sair</span>
          </button>
        </div>
      </aside>
      </aside>
    `}renderTopBar(e,t=""){return`
      <header class="top-bar">
        <button id="sidebar-toggle" class="menu-toggle-btn lg:hidden">
          <i class="fas fa-bars"></i>
        </button>
        <button id="sidebar-toggle-desktop-top" class="menu-toggle-btn hidden lg:flex" title="Abrir menu">
          <i class="fas fa-bars"></i>
        </button>
        <div>
          <h1 class="text-xl md:text-2xl font-bold text-white">${e}</h1>
          ${t?`<p class="text-sm text-gray-400">${t}</p>`:""}
        </div>
      </header>
    `}init(){const e=document.getElementById("sidebar"),t=document.getElementById("sidebar-toggle"),s=document.getElementById("sidebar-close"),a=document.getElementById("sidebar-overlay"),i=document.getElementById("logout-btn"),r=()=>{const o=document.querySelector(".main-content");o&&(window.innerWidth>=1024?e.classList.contains("collapsed")?(o.style.marginLeft="0",o.style.width="100%"):(e.classList.contains("desktop-open")||e.classList.contains("open"))&&(o.style.marginLeft="280px",o.style.width="calc(100% - 280px)"):(o.style.marginLeft="0",o.style.width="100%"))},n=()=>{e.classList.add("open"),a.classList.remove("hidden"),a.classList.add("show"),document.body.style.overflow="hidden",r()},c=()=>{e.classList.remove("open"),a.classList.remove("show"),setTimeout(()=>{a.classList.add("hidden")},300),document.body.style.overflow="",r()},l=()=>{e.classList.remove("desktop-open"),e.classList.add("collapsed"),localStorage.setItem("sidebar-collapsed","true");const o=document.getElementById("sidebar-toggle-desktop-top");o&&(o.style.display="flex"),r()},u=()=>{e.classList.remove("collapsed"),e.classList.add("desktop-open"),localStorage.setItem("sidebar-collapsed","false");const o=document.getElementById("sidebar-toggle-desktop-top");o&&(o.style.display="none"),r()},y=localStorage.getItem("sidebar-collapsed")==="true";if(window.innerWidth>=1024)if(y){e.classList.add("collapsed");const o=document.getElementById("sidebar-toggle-desktop-top");o&&(o.style.display="flex")}else{e.classList.add("desktop-open");const o=document.getElementById("sidebar-toggle-desktop-top");o&&(o.style.display="none")}r(),t&&t.addEventListener("click",()=>{window.innerWidth<1024&&n()});const d=document.getElementById("sidebar-toggle-desktop-top");d&&(window.innerWidth<1024&&(d.style.display="none"),d.addEventListener("click",()=>{if(window.innerWidth>=1024&&e.classList.contains("collapsed")){u();const o=document.getElementById("sidebar-toggle-desktop");o&&(o.innerHTML='<i class="fas fa-chevron-left"></i>',o.title="Fechar menu"),d.style.display="none"}})),s&&s.addEventListener("click",c),a&&a.addEventListener("click",c);const p=document.getElementById("sidebar-toggle-desktop");p&&p.addEventListener("click",()=>{e.classList.contains("collapsed")?(u(),p.innerHTML='<i class="fas fa-chevron-left"></i>',p.title="Fechar menu",d&&(d.style.display="none")):(l(),p.innerHTML='<i class="fas fa-chevron-right"></i>',p.title="Abrir menu",d&&(d.style.display="flex"))});const f=()=>{const o=document.getElementById("sidebar-toggle-desktop-top"),m=document.getElementById("sidebar-toggle");if(window.innerWidth>=1024){a.classList.add("hidden"),a.classList.remove("show"),document.body.style.overflow="",e.classList.remove("open"),m&&(m.style.display="none");const v=localStorage.getItem("sidebar-collapsed")==="true";v?(e.classList.add("collapsed"),e.classList.remove("desktop-open")):(e.classList.remove("collapsed"),e.classList.add("desktop-open"));const g=document.getElementById("sidebar-toggle-desktop");g&&(v?(g.innerHTML='<i class="fas fa-chevron-right"></i>',g.title="Abrir menu",o&&(o.style.display="flex")):(g.innerHTML='<i class="fas fa-chevron-left"></i>',g.title="Fechar menu",o&&(o.style.display="none")))}else e.classList.remove("collapsed","desktop-open"),m&&(m.style.display="flex"),o&&(o.style.display="none");r()};window.addEventListener("resize",f),f(),document.addEventListener("keydown",o=>{o.key==="Escape"&&e&&e.classList.contains("open")&&c()}),i&&i.addEventListener("click",()=>{sessionStorage.removeItem("authenticated"),sessionStorage.removeItem("username"),window.location.href="/index.html"})}}export{b as G,S as L,E as S};
