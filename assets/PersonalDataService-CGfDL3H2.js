const c="ambiente-dev",o={notes:`${c}-notes`,lists:`${c}-lists`,routine:`${c}-routine`,routineCheckmarks:`${c}-routine-checkmarks`,focusOfDay:`${c}-focus-of-day`,focusCheckmarks:`${c}-focus-checkmarks`,links:`${c}-links`};function l(d,t=null){try{const e=localStorage.getItem(d);return e?JSON.parse(e):t??[]}catch{return t??[]}}function r(d,t){localStorage.setItem(d,JSON.stringify(t))}class k{constructor(){this.initialized=!1}async initialize(){return this.initialized=!0,!0}getNotes(){return l(o.notes,[])}saveNote(t){const e=this.getNotes(),i=t.id||`note-${Date.now()}`,s=e.findIndex(a=>a.id===i),n={...t,id:i,updatedAt:new Date().toISOString()};return s>=0?e[s]=n:(n.createdAt=n.updatedAt,e.push(n)),r(o.notes,e),n}deleteNote(t){const e=this.getNotes().filter(i=>i.id!==t);return r(o.notes,e),{id:t}}getLists(){const t=[{id:"hoje",name:"Hoje",items:[],isDefault:!0,listType:"tasks"},{id:"esta-semana",name:"Esta semana",items:[],isDefault:!0,listType:"tasks"},{id:"quando-tiver-tempo",name:"Quando tiver tempo",items:[],isDefault:!0,listType:"tasks"},{id:"esperando",name:"Esperando alguém",items:[],isDefault:!0,listType:"tasks"}],e=l(o.lists,[]);if(e.length===0)return t;const i=e.map(s=>s.id);return t.forEach(s=>{if(!i.includes(s.id))e.push(s);else{const n=e.find(a=>a.id===s.id);n&&!n.listType&&(n.listType="tasks")}}),e.forEach(s=>{s.listType||(s.listType="tasks")}),e}saveLists(t){return r(o.lists,t),t}createList(t,e="tasks"){const i=this.getLists(),s={id:`list-${Date.now()}`,name:t.trim(),items:[],isDefault:!1,listType:e,createdAt:new Date().toISOString()};return i.push(s),r(o.lists,i),s}deleteList(t){const e=this.getLists(),i=e.find(s=>s.id===t);if(i&&!i.isDefault){const s=e.filter(n=>n.id!==t);return r(o.lists,s),{id:t}}return null}addListItem(t,e){const i=this.getLists(),s=i.find(a=>a.id===t);if(!s)return null;const n={id:`item-${Date.now()}`,text:e.trim(),done:!1,type:"text",createdAt:new Date().toISOString()};return s.items=s.items||[],s.items.push(n),r(o.lists,i),n}addNoteToList(t,e){const i=this.getLists(),s=i.find(a=>a.id===t);if(!s)return null;const n={id:e.id||`note-item-${Date.now()}`,type:"note",title:e.title||"",content:e.content||"",done:!1,createdAt:new Date().toISOString()};return s.items=s.items||[],s.items.push(n),r(o.lists,i),n}toggleListItem(t,e){const i=this.getLists(),s=i.find(a=>a.id===t);if(!s||!s.items)return null;const n=s.items.find(a=>a.id===e);return n?(n.done=!n.done,r(o.lists,i),n):null}removeListItem(t,e){const i=this.getLists(),s=i.find(n=>n.id===t);return!s||!s.items?null:(s.items=s.items.filter(n=>n.id!==e),r(o.lists,i),{id:e})}getRoutineBlocks(){const t=[{id:"block-1",title:"Bloco 1",timeRange:"10h - 14h",order:0,tasks:[{id:"task-1-1",label:"Responder redes sociais",order:0},{id:"task-1-2",label:"Editar vídeos do dia seguinte",order:1},{id:"task-1-3",label:"Agendar vídeos",order:2},{id:"task-1-4",label:"Postar Kwai",order:3}]},{id:"block-2",title:"Bloco 2",timeRange:"14h - 15h",order:1,tasks:[{id:"task-2-1",label:"Preparar roteiros / organizar imagens",order:0},{id:"task-2-2",label:"Postar Kwai",order:1}]},{id:"block-3",title:"Bloco 2 (continuação)",timeRange:"15h - 16h",order:2,tasks:[{id:"task-3-1",label:"Almoço / ouvir 10 min do livro",order:0}]},{id:"block-4",title:"Bloco 3",timeRange:"16h - 17h",order:3,tasks:[{id:"task-4-1",label:"Aprender coisas, ver algo que gere valor",order:0}]},{id:"block-5",title:"Bloco 3 (continuação)",timeRange:"17h - 19h",order:4,tasks:[{id:"task-5-1",label:"Editar vídeos",order:0},{id:"task-5-2",label:"Agendar",order:1}]}],e=l(o.routine,[]);return e.length>0?e:t}saveRoutineBlocks(t){return r(o.routine,t),t}addRoutineTask(t,e){const i=this.getRoutineBlocks(),s=i.find(u=>u.id===t);if(!s)return null;s.tasks=s.tasks||[];const n=s.tasks.length?Math.max(...s.tasks.map(u=>u.order)):-1,a={id:`task-${Date.now()}`,label:e.trim(),order:n+1};return s.tasks.push(a),r(o.routine,i),a}removeRoutineTask(t,e){const i=this.getRoutineBlocks(),s=i.find(n=>n.id===t);return!s||!s.tasks?null:(s.tasks=s.tasks.filter(n=>n.id!==e),r(o.routine,i),{id:e})}getRoutineItems(){const t=this.getRoutineBlocks(),e=[];return t.forEach(i=>{i.tasks&&i.tasks.forEach(s=>{e.push({id:s.id,label:s.label,order:i.order*1e3+s.order,blockId:i.id})})}),e}saveRoutineItems(t){const e=this.getRoutineBlocks();return r(o.routine,e),e}addRoutineItem(t){const e=this.getRoutineBlocks();e.length===0&&e.push({id:`block-${Date.now()}`,title:"Tarefas",timeRange:"",order:0,tasks:[]});const i=e[e.length-1];return this.addRoutineTask(i.id,t)}removeRoutineItem(t){const e=this.getRoutineBlocks();for(const i of e)if(i.tasks&&i.tasks.find(n=>n.id===t))return this.removeRoutineTask(i.id,t);return{id:t}}reorderRoutineItems(t){return this.getRoutineBlocks()}getRoutineCheckmarks(){return l(o.routineCheckmarks,{})}setRoutineCheckmark(t,e,i){const s=this.getRoutineCheckmarks();return s[t]||(s[t]={}),s[t][e]=i,r(o.routineCheckmarks,s),s[t]}getRoutineCheckmarksForDate(t){return this.getRoutineCheckmarks()[t]||{}}getFocusOfDay(t){return l(o.focusOfDay,{})[t]||{items:[]}}setFocusOfDay(t,e){const i=l(o.focusOfDay,{});return i[t]={items:e.slice(0,3),updatedAt:new Date().toISOString()},r(o.focusOfDay,i),i[t]}getFocusCheckmarks(t){return l(o.focusCheckmarks,{})[t]||{}}setFocusCheckmark(t,e,i){const s=l(o.focusCheckmarks,{});return s[t]||(s[t]={}),s[t][String(e)]=i,r(o.focusCheckmarks,s),s[t]}getLinks(){return l(o.links,[])}saveLink(t){const e=this.getLinks(),i=t.id||`link-${Date.now()}`,s=e.findIndex(a=>a.id===i),n={id:i,title:t.title||"",url:t.url||"",tags:t.tags||[],updatedAt:new Date().toISOString()};return s>=0?e[s]={...e[s],...n}:(n.createdAt=n.updatedAt,e.push(n)),r(o.links,e),n}deleteLink(t){const e=this.getLinks().filter(i=>i.id!==t);return r(o.links,e),{id:t}}}export{k as P};
